---
title: Microsoft Graph 数据连接中的用户选择和筛选功能
description: 介绍了如何使用 Microsoft Graph 数据连接来选择用户以提取其数据，以及筛选返回的数据。
author: fercobo-msft
localization_priority: Priority
ms.prod: data-connect
ms.openlocfilehash: c29c088ac4efc7d286e8d10b92edd5bcbac373a6
ms.sourcegitcommit: 276a13a37c3772689dfc71f7cd47586c9581f27d
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/24/2021
ms.locfileid: "52629376"
---
# <a name="user-selection-and-filtering-capabilities-in-microsoft-graph-data-connect"></a><span data-ttu-id="81b92-103">Microsoft Graph 数据连接中的用户选择和筛选功能</span><span class="sxs-lookup"><span data-stu-id="81b92-103">User selection and filtering capabilities in Microsoft Graph Data Connect</span></span>

<span data-ttu-id="81b92-104">你可以使用 Microsoft Graph 数据连接来选择要提取其数据的用户，并包含筛选器以限制返回的数据。</span><span class="sxs-lookup"><span data-stu-id="81b92-104">You can use Microsoft Graph Data Connect to select the users that you want to extract data for, and to include filters to limit the data returned.</span></span> <span data-ttu-id="81b92-105">本文介绍数据连接提供的用户选择选项，以及它支持的筛选功能。</span><span class="sxs-lookup"><span data-stu-id="81b92-105">This article describes the user selection options that Data Connect provides and the filtering that it supports.</span></span>

## <a name="user-selection"></a><span data-ttu-id="81b92-106">用户选择</span><span class="sxs-lookup"><span data-stu-id="81b92-106">User selection</span></span>

<span data-ttu-id="81b92-107">可以针对一组用户运行管道。</span><span class="sxs-lookup"><span data-stu-id="81b92-107">You can run pipelines on a set of users.</span></span> <span data-ttu-id="81b92-108">下面是适用于用户选择的选项：</span><span class="sxs-lookup"><span data-stu-id="81b92-108">The following are the options for user selection:</span></span>

- <span data-ttu-id="81b92-109">组织内的所有用户</span><span class="sxs-lookup"><span data-stu-id="81b92-109">All users within the organization</span></span>
- <span data-ttu-id="81b92-110">对组织内最多 10 个用户组运行</span><span class="sxs-lookup"><span data-stu-id="81b92-110">Up to 10 groups of users within the organization to run on</span></span>
- <span data-ttu-id="81b92-111">基于由 Azure Active Directory 用户属性组成的谓词的一组用户。</span><span class="sxs-lookup"><span data-stu-id="81b92-111">A set of users based on a predicate consisting of Azure Active Directory user properties</span></span>

<span data-ttu-id="81b92-112">在 Azure 数据工厂复制活动的 SourceDataSet 中指定用户选择。</span><span class="sxs-lookup"><span data-stu-id="81b92-112">Specify your user selection in the SourceDataSet of the Azure Data Factory copy activity.</span></span> <span data-ttu-id="81b92-113">若要针对组列表运行，请在 **typeProperties** 下添加一个新字段 **allowedGroups**，并将此字段设置为最多 10 个组的列表，**对象 Id** 由逗号分隔。</span><span class="sxs-lookup"><span data-stu-id="81b92-113">To run on a list of groups, add a new field **allowedGroups** under **typeProperties** and set this to a list of up to 10 groups' **Object Ids** separated by commas.</span></span> <span data-ttu-id="81b92-114">如果默认情况下未指定组，则将为整个组织提取数据。</span><span class="sxs-lookup"><span data-stu-id="81b92-114">If no groups are specified by default, data will be extracted for the entire organization.</span></span>

<span data-ttu-id="81b92-115">若要指定针对整个租户运行的谓词，请在 **typeProperties** 下添加一个新字段 **userScopeFilterUri**，并将此字段设置为该谓词。</span><span class="sxs-lookup"><span data-stu-id="81b92-115">To specify a predicate to run on the entire tenant, add a new field **userScopeFilterUri** under **typeProperties** and set this to the predicate.</span></span> <span data-ttu-id="81b92-116">谓词格式应与 Microsoft Graph API 的查询格式匹配。</span><span class="sxs-lookup"><span data-stu-id="81b92-116">The predicate format should match the query format of Microsoft Graph APIs.</span></span> <span data-ttu-id="81b92-117">例如，如果要仅选择在财务部门工作的用户，你可以使用 `https://graph.microsoft.com/v1.0/users?$filter=Department eq 'Finance'`。</span><span class="sxs-lookup"><span data-stu-id="81b92-117">For example, if you want to limit the selection to users who work in the Finance department, you can use `https://graph.microsoft.com/v1.0/users?$filter=Department eq 'Finance'`.</span></span> <span data-ttu-id="81b92-118">如果要仅选择一个用户，可使用 `https://graph.microsoft.com/v1.0/users?$filter=mail eq 'contosouser1@contoso.com'`。</span><span class="sxs-lookup"><span data-stu-id="81b92-118">If you want to limit the selection to one user, you can use `https://graph.microsoft.com/v1.0/users?$filter=mail eq 'contosouser1@contoso.com'`.</span></span>

<span data-ttu-id="81b92-119">查询将仅返回你所查询的 Microsoft 365 组织内的用户。</span><span class="sxs-lookup"><span data-stu-id="81b92-119">Your query will only return users within the Microsoft 365 organization that you're querying.</span></span> <span data-ttu-id="81b92-120">将不会返回来宾用户和非用户邮箱。</span><span class="sxs-lookup"><span data-stu-id="81b92-120">Guest users and non-user mailboxes will not be returned.</span></span>

## <a name="filtering"></a><span data-ttu-id="81b92-121">筛选</span><span class="sxs-lookup"><span data-stu-id="81b92-121">Filtering</span></span>

<span data-ttu-id="81b92-122">可以使用日期时间属性来限制查询提取到的结果。</span><span class="sxs-lookup"><span data-stu-id="81b92-122">You can limit the results extracted for your query using DateTime properties.</span></span> <span data-ttu-id="81b92-123">根据所请求数据的类型，可能需要日期时间筛选器。</span><span class="sxs-lookup"><span data-stu-id="81b92-123">Depending on the type of data requested, a DateTime filter might be required.</span></span> <span data-ttu-id="81b92-124">日期时间筛选器使用的属性由 Azure 数据工厂复制活动的 SourceDataSet 提供。</span><span class="sxs-lookup"><span data-stu-id="81b92-124">The DateTime filter is provided using properties in the SourceDataSet of the Azure Data Factory copy activity.</span></span> <span data-ttu-id="81b92-125">若要指定日期时间筛选器，请在 **typeProperties** 下添加一个新字段 **dateFilterColumn**，并将此字段设置为下表中支持筛选的属性之一。</span><span class="sxs-lookup"><span data-stu-id="81b92-125">To specify a DateTime filter, add a new field **dateFilterColumn** under **typeProperties** and set this to one of the properties that support filtering in the following table.</span></span> <span data-ttu-id="81b92-126">接着，添加表示日期时间值的 **startTime** 和 **endTime**，系统将依据这些值对属性进行筛选。</span><span class="sxs-lookup"><span data-stu-id="81b92-126">Next, add a **startTime** and **endTime** that represent the DateTime values that the property will be filtered upon.</span></span>

<span data-ttu-id="81b92-127">以下数据集需要针对相应的其中一个日期时间属性提供筛选器。</span><span class="sxs-lookup"><span data-stu-id="81b92-127">The following datasets require a filter to be provided on one of the corresponding DateTime properties.</span></span>

| <span data-ttu-id="81b92-128">数据集名称</span><span class="sxs-lookup"><span data-stu-id="81b92-128">Dataset name</span></span>                                               | <span data-ttu-id="81b92-129">支持筛选的属性</span><span class="sxs-lookup"><span data-stu-id="81b92-129">Properties that support filtering</span></span>                                           |
| ---------------------------------------------------------- | --------------------------------------------------------------------------- |
| <span data-ttu-id="81b92-130">BasicDataSet_v0.Event_v0</span><span class="sxs-lookup"><span data-stu-id="81b92-130">BasicDataSet_v0.Event_v0</span></span><br><span data-ttu-id="81b92-131">BasicDataSet_v0.Event_v1</span><span class="sxs-lookup"><span data-stu-id="81b92-131">BasicDataSet_v0.Event_v1</span></span>       | <span data-ttu-id="81b92-132">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-132">CreatedDateTime</span></span><br><span data-ttu-id="81b92-133">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-133">LastModifiedDateTime</span></span>                                     |
| <span data-ttu-id="81b92-134">BasicDataSet_v0.Message_v0</span><span class="sxs-lookup"><span data-stu-id="81b92-134">BasicDataSet_v0.Message_v0</span></span><br><span data-ttu-id="81b92-135">BasicDataSet_v0.Message_v1</span><span class="sxs-lookup"><span data-stu-id="81b92-135">BasicDataSet_v0.Message_v1</span></span>   | <span data-ttu-id="81b92-136">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-136">CreatedDateTime</span></span><br><span data-ttu-id="81b92-137">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-137">LastModifiedDateTime</span></span><br><span data-ttu-id="81b92-138">ReceivedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-138">ReceivedDateTime</span></span><br><span data-ttu-id="81b92-139">SentDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-139">SentDateTime</span></span> |
| <span data-ttu-id="81b92-140">BasicDataSet_v0.SentItem_v0</span><span class="sxs-lookup"><span data-stu-id="81b92-140">BasicDataSet_v0.SentItem_v0</span></span><br><span data-ttu-id="81b92-141">BasicDataSet_v0.SentItem_v1</span><span class="sxs-lookup"><span data-stu-id="81b92-141">BasicDataSet_v0.SentItem_v1</span></span> | <span data-ttu-id="81b92-142">CreatedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-142">CreatedDateTime</span></span><br><span data-ttu-id="81b92-143">LastModifiedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-143">LastModifiedDateTime</span></span><br><span data-ttu-id="81b92-144">ReceivedDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-144">ReceivedDateTime</span></span><br><span data-ttu-id="81b92-145">SentDateTime</span><span class="sxs-lookup"><span data-stu-id="81b92-145">SentDateTime</span></span> |

> [!NOTE]
> <span data-ttu-id="81b92-146">请求 BasicDataSet_v0.CalendarView_v0 的管道也需要日期时间筛选器，但 SourceDataSet 中未指定 **dateFilterColumn**。</span><span class="sxs-lookup"><span data-stu-id="81b92-146">Pipelines requesting BasicDataSet_v0.CalendarView_v0 also require a DateTime filter, but no **dateFilterColumn** is specified in the SourceDataSet.</span></span> <span data-ttu-id="81b92-147">但是，需要 **startTime** 和 **endTime**，且只提供了在 **startTime** 之后开始并在 **endTime** 之前完成的事件。</span><span class="sxs-lookup"><span data-stu-id="81b92-147">However, a **startTime** and **endTime** are required and only events that begin after the **startTime** and finish before the **endTime** are provided.</span></span>

## <a name="see-also"></a><span data-ttu-id="81b92-148">另请参阅</span><span class="sxs-lookup"><span data-stu-id="81b92-148">See also</span></span>

- [<span data-ttu-id="81b92-149">与 PAM 集成</span><span class="sxs-lookup"><span data-stu-id="81b92-149">Integrate with PAM</span></span>](data-connect-pam.md)
- [<span data-ttu-id="81b92-150">数据连接常见问题解答</span><span class="sxs-lookup"><span data-stu-id="81b92-150">Data Connect frequently asked questions</span></span>](data-connect-faq.md)
