---
title: Microsoft Graph 中 Excel API 的错误处理
description: Microsoft Graph 中 Excel API 的错误处理说明
author: grangeryy
localization_priority: Normal
ms.prod: excel
ms.openlocfilehash: 5d5a420b4968b0a944ac192de5654692678663c8
ms.sourcegitcommit: b0194231721c68053a0be6d8eb46687574eb8d71
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/18/2021
ms.locfileid: "50293076"
---
# <a name="error-handling-for-excel-apis-in-microsoft-graph"></a><span data-ttu-id="1661b-103">Microsoft Graph 中 Excel API 的错误处理</span><span class="sxs-lookup"><span data-stu-id="1661b-103">Error handling for Excel APIs in Microsoft Graph</span></span>

<span data-ttu-id="1661b-104">本文提供有关处理通过 API 发送的请求失败时 Microsoft Graph 中的 Excel API 返回的错误的一般说明和建议。</span><span class="sxs-lookup"><span data-stu-id="1661b-104">This article provides general instructions and suggestions for handling errors that are returned by the Excel APIs in Microsoft Graph when a request sent through the API fails.</span></span>

## <a name="types-of-error-responses"></a><span data-ttu-id="1661b-105">错误响应的类型</span><span class="sxs-lookup"><span data-stu-id="1661b-105">Types of error responses</span></span>

<span data-ttu-id="1661b-106">Microsoft Graph 中的 Excel API 返回两种类型的错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-106">Excel APIs in Microsoft Graph return two types of errors.</span></span> <span data-ttu-id="1661b-107">一种是常规错误响应，如下所示。</span><span class="sxs-lookup"><span data-stu-id="1661b-107">One is the regular error response, which looks like the following.</span></span>

```http
HTTP/1.1 <HTTP status code>
Content-type: application/json

{
  "error": <Error object>
}
```

<span data-ttu-id="1661b-108">第二个来自长时间运行的操作模式，该模式可在响应正文中返回 HTTP 状态代码和操作 `200 OK` `failed` 状态，如以下示例所示。</span><span class="sxs-lookup"><span data-stu-id="1661b-108">The second is from the long-running operation pattern, which can return a `200 OK` HTTP status code and `failed` operation status in response body, as in the following example.</span></span>

```http
HTTP/1.1 200 OK
Content-type: application/json

{
  "status": "failed",
  "error": <Error object>
}
```

<span data-ttu-id="1661b-109">对于这两种错误响应，错误对象具有以下结构。</span><span class="sxs-lookup"><span data-stu-id="1661b-109">For both of these error responses, the error object has the following structure.</span></span>

><span data-ttu-id="1661b-110">**注意：** 错误响应遵循 [OData v4 规范](https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793091) 中有关错误响应的定义。</span><span class="sxs-lookup"><span data-stu-id="1661b-110">**Note:** Error responses follow the definition in the [OData v4](https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793091) specification for error responses.</span></span>

```json
{
  "code": "string",
  "message": "string",
  "innerError": { "@odata.type": "odata.error" }
}
```

<span data-ttu-id="1661b-111">`innerError` 对象可能以递归方式包含更多 `innerError` 对象，其中具有其他更多具体的错误代码。</span><span class="sxs-lookup"><span data-stu-id="1661b-111">The `innerError` object might recursively contain more `innerError` objects with additional, more specific error codes.</span></span> <span data-ttu-id="1661b-112">例如，错误对象可能包含第二级错误代码和消息中更详细的错误信息，如下所示。</span><span class="sxs-lookup"><span data-stu-id="1661b-112">For example, the error object might contain more detailed error information in the second-level error code and message, as shown.</span></span>

```json
{
  "code": "Top-level error code",
  "message": "Top-level error message",
  "innerError": {
    "code": "Second-level error code",
    "message": "Second-level error message",
    "innerError": { "@odata.type": "odata.error" }
  }
}
```

## <a name="steps-to-handle-error-responses"></a><span data-ttu-id="1661b-113">处理错误响应的步骤</span><span class="sxs-lookup"><span data-stu-id="1661b-113">Steps to handle error responses</span></span>

<span data-ttu-id="1661b-114">Microsoft Graph 客户端可以使用以下步骤来处理 Excel API 发生的错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-114">Microsoft Graph clients can use the following steps to handle errors that occur with Excel APIs.</span></span>

### <a name="1-determine-whether-it-is-a-long-running-operation-error"></a><span data-ttu-id="1661b-115">1. 确定它是否是长时间运行的操作错误</span><span class="sxs-lookup"><span data-stu-id="1661b-115">1. Determine whether it is a long-running operation error</span></span>

<span data-ttu-id="1661b-116">在处理错误之前，第一步是确定错误响应来自长时间运行的操作模式还是常规模式。</span><span class="sxs-lookup"><span data-stu-id="1661b-116">Before handling an error, the first step is to determine whether the error response is from a long-running operation pattern or a regular pattern.</span></span> <span data-ttu-id="1661b-117">长时间运行的操作错误将在响应正文中返回 `200 OK` HTTP `failed` 状态代码和操作状态。</span><span class="sxs-lookup"><span data-stu-id="1661b-117">A long-running operation error will return a `200 OK` HTTP status code and `failed` operation status in response body.</span></span> <span data-ttu-id="1661b-118">常规错误响应将返回相应的 HTTP 错误状态代码。</span><span class="sxs-lookup"><span data-stu-id="1661b-118">A regular error response will return a corresponding HTTP error status code.</span></span> 

### <a name="2-parse-second-level-error-code"></a><span data-ttu-id="1661b-119">2. 分析二级错误代码</span><span class="sxs-lookup"><span data-stu-id="1661b-119">2. Parse second-level error code</span></span>

<span data-ttu-id="1661b-120">对于长时间运行的操作模式和常规模式，我们建议您首先按照说明处理二级错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-120">For both the long-running operation pattern and the regular pattern, we recommend that you first follow the instructions for second-level errors.</span></span> <span data-ttu-id="1661b-121">错误代码不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="1661b-121">The error code is case insensitive.</span></span> <span data-ttu-id="1661b-122">下表列出了某些错误的说明。</span><span class="sxs-lookup"><span data-stu-id="1661b-122">The following table lists instructions for some of the errors.</span></span> <span data-ttu-id="1661b-123">该服务可能随时添加新的错误代码。</span><span class="sxs-lookup"><span data-stu-id="1661b-123">The service might add new error codes at any time.</span></span>

| <span data-ttu-id="1661b-124">代码</span><span class="sxs-lookup"><span data-stu-id="1661b-124">Code</span></span>                               | <span data-ttu-id="1661b-125">说明</span><span class="sxs-lookup"><span data-stu-id="1661b-125">Instructions</span></span>
|:-----------------------------------|:---------------------------------------------
| <span data-ttu-id="1661b-126">**accessConflict**</span><span class="sxs-lookup"><span data-stu-id="1661b-126">**accessConflict**</span></span>   | <span data-ttu-id="1661b-127">失败的请求与其他访问工作簿的客户端冲突 (例如，另一个客户端锁定工作簿进行编辑) 。</span><span class="sxs-lookup"><span data-stu-id="1661b-127">The failed request conflicts with other clients accessing the workbook (for example, another client has locked the workbook for edit).</span></span> <span data-ttu-id="1661b-128">在解决冲突之前，Microsoft Graph 客户端不会重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-128">The Microsoft Graph client is not expected to resend the failed request until the conflict is resolved.</span></span> <span data-ttu-id="1661b-129">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取有关冲突的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="1661b-129">An end user can choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="1661b-130">**accessDenied**</span><span class="sxs-lookup"><span data-stu-id="1661b-130">**accessDenied**</span></span>   | <span data-ttu-id="1661b-131">不能执行请求的操作 (例如，对锁定的单元格执行) 。</span><span class="sxs-lookup"><span data-stu-id="1661b-131">You cannot perform the requested operation (for example, performing changes to locked cells).</span></span> <span data-ttu-id="1661b-132">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-132">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-133">**badRequestUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-133">**badRequestUncategorized**</span></span>    | <span data-ttu-id="1661b-134">在失败的请求中发现未指定的错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-134">An unspecified error is found in the failed request.</span></span> <span data-ttu-id="1661b-135">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-135">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-136">**conflictUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-136">**conflictUncategorized**</span></span>                   | <span data-ttu-id="1661b-137">失败的请求与某些服务器状态冲突。</span><span class="sxs-lookup"><span data-stu-id="1661b-137">The failed request conflicts with certain server state.</span></span> <span data-ttu-id="1661b-138">在解决冲突之前，Microsoft Graph 客户端不会重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-138">The Microsoft Graph client is not expected to resend the failed request until the conflict is resolved.</span></span> <span data-ttu-id="1661b-139">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取有关冲突的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="1661b-139">An end user can choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="1661b-140">**filteredRangeConflict**</span><span class="sxs-lookup"><span data-stu-id="1661b-140">**filteredRangeConflict**</span></span>                   | <span data-ttu-id="1661b-141">操作失败，因为它与筛选出的范围冲突。</span><span class="sxs-lookup"><span data-stu-id="1661b-141">The operation failed because it conflicts with a filtered range.</span></span> <span data-ttu-id="1661b-142">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-142">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-143">**forbiddenUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-143">**forbiddenUncategorized**</span></span>                    | <span data-ttu-id="1661b-144">不允许失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-144">The failed request is not allowed.</span></span> <span data-ttu-id="1661b-145">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-145">The Microsoft Graph client is not expected to resend the failed request.</span></span> <span data-ttu-id="1661b-146">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取有关限制的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="1661b-146">An end user can choose to manually perform the same operations with Excel Online to get more details about the restrictions.</span></span>
| <span data-ttu-id="1661b-147">**gatewayTimeoutUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-147">**gatewayTimeoutUncategorized**</span></span>         | <span data-ttu-id="1661b-148">服务无法在此时间限制内完成请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-148">The service wasn’t able to complete the request within the time limit.</span></span>
| <span data-ttu-id="1661b-149">**generalException**</span><span class="sxs-lookup"><span data-stu-id="1661b-149">**generalException**</span></span>         | <span data-ttu-id="1661b-150">处理请求时出现内部错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-150">An internal error occurred while processing the request.</span></span> <span data-ttu-id="1661b-151">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-151">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-152">**insertDeleteConflict**</span><span class="sxs-lookup"><span data-stu-id="1661b-152">**insertDeleteConflict**</span></span>         | <span data-ttu-id="1661b-153">尝试的插入或删除操作导致冲突。</span><span class="sxs-lookup"><span data-stu-id="1661b-153">The insert or delete operation attempted resulted in a conflict.</span></span> <span data-ttu-id="1661b-154">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-154">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-155">**internalServerErrorUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-155">**internalServerErrorUncategorized**</span></span>       | <span data-ttu-id="1661b-156">发生未指定错误。</span><span class="sxs-lookup"><span data-stu-id="1661b-156">An unspecified error has occurred.</span></span> <span data-ttu-id="1661b-157">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-157">The Microsoft Graph client is not expected to resend the failed request.</span></span> <span data-ttu-id="1661b-158">如果在失败的请求中指定了会话，则不需要进一步访问会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-158">If a session is specified in the failed request, further access to the session is not expected either.</span></span>
| <span data-ttu-id="1661b-159">**invalidArgument**</span><span class="sxs-lookup"><span data-stu-id="1661b-159">**invalidArgument**</span></span>         | <span data-ttu-id="1661b-160">自变量无效、缺少或格式不正确。</span><span class="sxs-lookup"><span data-stu-id="1661b-160">The argument is invalid or missing or has an incorrect format.</span></span> <span data-ttu-id="1661b-161">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-161">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-162">**invalidReference**</span><span class="sxs-lookup"><span data-stu-id="1661b-162">**invalidReference**</span></span>         | <span data-ttu-id="1661b-163">此引用对于当前操作无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-163">This reference is not valid for the current operation.</span></span> <span data-ttu-id="1661b-164">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-164">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-165">**invalidSessionAccessConflict**</span><span class="sxs-lookup"><span data-stu-id="1661b-165">**invalidSessionAccessConflict**</span></span>             | <span data-ttu-id="1661b-166">由于与其他访问工作簿的客户端发生冲突，请求中指定的会话无效 (例如，另一个客户端锁定了工作簿进行编辑) 。</span><span class="sxs-lookup"><span data-stu-id="1661b-166">The session specified in the request is invalid due to conflicts with other clients that are accessing the workbook (for example, another client has locked the workbook for edit).</span></span> <span data-ttu-id="1661b-167">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-167">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-168">在解决冲突之前，不需要重新创建具有相同 **createSession** 请求的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-168">Recreating sessions with the same **createSession** request is not expected until the conflict is resolved.</span></span> <span data-ttu-id="1661b-169">使用不同的 **createSession** 请求重新创建会话可能会成功，也可能失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-169">Recreating sessions with a different **createSession** request might or might not succeed.</span></span> <span data-ttu-id="1661b-170">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取有关冲突的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="1661b-170">An end user can choose to manually perform the same operations with Excel Online to get more details about the conflict.</span></span>
| <span data-ttu-id="1661b-171">**invalidSessionAuthentication**</span><span class="sxs-lookup"><span data-stu-id="1661b-171">**invalidSessionAuthentication**</span></span>         | <span data-ttu-id="1661b-172">由于身份验证错误，请求中指定的会话无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-172">The session specified in the request is invalid due to an authentication error.</span></span> <span data-ttu-id="1661b-173">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-173">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-174">在提供适当的身份验证信息之前，不应使用相同的 **createSession** 请求重新创建会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-174">Recreating sessions with the same **createSession** request is not expected until appropriate authentication information is provided.</span></span>
| <span data-ttu-id="1661b-175">**invalidSessionNotFound**</span><span class="sxs-lookup"><span data-stu-id="1661b-175">**invalidSessionNotFound**</span></span>         | <span data-ttu-id="1661b-176">请求中指定的会话无效，因为找不到工作簿。</span><span class="sxs-lookup"><span data-stu-id="1661b-176">The session specified in the request is invalid because the workbook can’t be found.</span></span> <span data-ttu-id="1661b-177">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-177">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-178">不需要使用相同的 **createSession** 请求重新创建会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-178">Recreating sessions with the same **createSession** request is not expected.</span></span>
| <span data-ttu-id="1661b-179">**invalidSessionReCreatable**</span><span class="sxs-lookup"><span data-stu-id="1661b-179">**invalidSessionReCreatable**</span></span>             | <span data-ttu-id="1661b-180">请求中指定的会话不存在或由于暂时性错误而无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-180">The session specified in the request does not exist or is invalid due to a transient error.</span></span> <span data-ttu-id="1661b-181">Microsoft Graph 客户端可以尝试重新创建会话并恢复工作。</span><span class="sxs-lookup"><span data-stu-id="1661b-181">The Microsoft Graph client can try to recreate a session and resume the work.</span></span> <span data-ttu-id="1661b-182">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-182">Further access to the session specified in the failed request is not expected.</span></span>
| <span data-ttu-id="1661b-183">**invalidSessionRestricted**</span><span class="sxs-lookup"><span data-stu-id="1661b-183">**invalidSessionRestricted**</span></span>          | <span data-ttu-id="1661b-184">由于服务配置或限制，请求中指定的会话无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-184">The session specified in the request is invalid due to service configurations or restrictions.</span></span> <span data-ttu-id="1661b-185">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-185">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-186">在阻止请求的限制或配置更改之前，不需要重新创建具有相同 **createSession** 请求的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-186">Recreating sessions with the same **createSession** request is not expected until the restrictions or configurations blocking the request changes.</span></span> <span data-ttu-id="1661b-187">使用不同的 **createSession** 请求重新创建会话可能会成功，也可能失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-187">Recreating sessions with a different **createSession** request might or might not succeed.</span></span> <span data-ttu-id="1661b-188">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取限制的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="1661b-188">An end user can choose to manually perform the same operations with Excel Online to get more details of the restrictions.</span></span>
| <span data-ttu-id="1661b-189">**invalidSessionUnexpected**</span><span class="sxs-lookup"><span data-stu-id="1661b-189">**invalidSessionUnexpected**</span></span>                | <span data-ttu-id="1661b-190">由于意外问题，请求中指定的会话无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-190">The session specified in the request is invalid due to an unexpected issue.</span></span> <span data-ttu-id="1661b-191">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-191">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-192">不需要使用相同的 **createSession** 请求重新创建会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-192">Recreating sessions with the same **createSession** request is not expected.</span></span> <span data-ttu-id="1661b-193">使用不同的 **createSession** 请求重新创建会话可能会成功，也可能失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-193">Recreating sessions with a different **createSession** request might or might not succeed.</span></span>
| <span data-ttu-id="1661b-194">**invalidSessionUnsupportedWorkbook**</span><span class="sxs-lookup"><span data-stu-id="1661b-194">**invalidSessionUnsupportedWorkbook**</span></span>              | <span data-ttu-id="1661b-195">请求中指定的会话无效，因为工作簿包含不受支持的功能或超出大小限制。</span><span class="sxs-lookup"><span data-stu-id="1661b-195">The session specified in the request is invalid because the workbook contains unsupported features or exceeds the size limit.</span></span> <span data-ttu-id="1661b-196">通常，不受支持的因素由访问工作簿的另一个客户端引入。</span><span class="sxs-lookup"><span data-stu-id="1661b-196">Usually the unsupported factors are introduced by another client accessing the workbook.</span></span> <span data-ttu-id="1661b-197">不应进一步访问失败请求中指定的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-197">Further access to the session specified in the failed request is not expected.</span></span> <span data-ttu-id="1661b-198">在删除不受支持的因素之前，不需要重新创建具有相同 **createSession** 请求的会话。</span><span class="sxs-lookup"><span data-stu-id="1661b-198">Recreating sessions with the same **createSession** request is not expected until the unsupported factors are removed.</span></span> <span data-ttu-id="1661b-199">使用不同的 createSession 请求重新创建会话可能会成功，也可能失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-199">Recreating sessions with a different createSession request might or might not succeed.</span></span> <span data-ttu-id="1661b-200">最终用户可以选择使用 Excel Online 手动执行相同的操作，获取不受支持因素的更多详细信息，也可以选择使用 Excel 桌面（其中工作簿可能受支持）。</span><span class="sxs-lookup"><span data-stu-id="1661b-200">An end user can choose to manually perform the same operations with Excel Online to get more details of the unsupported factors, or with Excel Desktop where the workbook might be supported.</span></span>
| <span data-ttu-id="1661b-201">**itemAlreadyExists**</span><span class="sxs-lookup"><span data-stu-id="1661b-201">**itemAlreadyExists**</span></span>         | <span data-ttu-id="1661b-202">所创建的资源已存在。</span><span class="sxs-lookup"><span data-stu-id="1661b-202">The resource being created already exists.</span></span> <span data-ttu-id="1661b-203">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-203">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-204">**itemNotFound**</span><span class="sxs-lookup"><span data-stu-id="1661b-204">**itemNotFound**</span></span>         | <span data-ttu-id="1661b-205">所请求的资源不存在。</span><span class="sxs-lookup"><span data-stu-id="1661b-205">The requested resource doesn't exist.</span></span> <span data-ttu-id="1661b-206">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-206">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-207">**methodNotAllowed**</span><span class="sxs-lookup"><span data-stu-id="1661b-207">**methodNotAllowed**</span></span>         | <span data-ttu-id="1661b-208">资源上不允许使用请求中指定的 HTTP 方法。</span><span class="sxs-lookup"><span data-stu-id="1661b-208">The HTTP method specified in the request is not allowed on the resource.</span></span> <span data-ttu-id="1661b-209">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-209">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-210">**methodNotAllowedUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-210">**methodNotAllowedUncategorized**</span></span>              | <span data-ttu-id="1661b-211">资源上不允许使用请求中指定的 HTTP 方法。</span><span class="sxs-lookup"><span data-stu-id="1661b-211">The HTTP method specified in the request is not allowed on the resource.</span></span> <span data-ttu-id="1661b-212">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-212">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-213">**nonBlankCellOffSheet**</span><span class="sxs-lookup"><span data-stu-id="1661b-213">**nonBlankCellOffSheet**</span></span>         | <span data-ttu-id="1661b-214">无法插入新单元格，因为它会将非空单元格推送到工作表的末尾。</span><span class="sxs-lookup"><span data-stu-id="1661b-214">Can't insert new cells because it would push non-empty cells off the end of the worksheet.</span></span> <span data-ttu-id="1661b-215">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-215">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-216">**notFoundUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-216">**notFoundUncategorized**</span></span>             | <span data-ttu-id="1661b-217">找不到请求的资源。</span><span class="sxs-lookup"><span data-stu-id="1661b-217">The requested resource cannot be found.</span></span> <span data-ttu-id="1661b-218">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-218">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-219">**notImplementedUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-219">**notImplementedUncategorized**</span></span>            | <span data-ttu-id="1661b-220">请求的功能当前未实现。</span><span class="sxs-lookup"><span data-stu-id="1661b-220">The requested feature is not currently implemented.</span></span> <span data-ttu-id="1661b-221">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-221">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-222">**payloadTooLargeUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-222">**payloadTooLargeUncategorized**</span></span>              | <span data-ttu-id="1661b-223">请求有效负载超过大小限制。</span><span class="sxs-lookup"><span data-stu-id="1661b-223">The request payload exceeds the size limit.</span></span> <span data-ttu-id="1661b-224">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-224">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-225">**rangeExceedsLimit**</span><span class="sxs-lookup"><span data-stu-id="1661b-225">**rangeExceedsLimit**</span></span>         | <span data-ttu-id="1661b-226">范围中的单元格计数已超出支持的最大数。</span><span class="sxs-lookup"><span data-stu-id="1661b-226">The cell count in range has exceeded the maximum supported number.</span></span> <span data-ttu-id="1661b-227">Microsoft Graph 客户端可以尝试发送范围较小的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-227">The Microsoft Graph client can try to send a request with smaller range size.</span></span>
| <span data-ttu-id="1661b-228">**requestAborted**</span><span class="sxs-lookup"><span data-stu-id="1661b-228">**requestAborted**</span></span>         | <span data-ttu-id="1661b-229">请求在运行期间中止，这通常是由工作簿中函数的长时间计算导致的。</span><span class="sxs-lookup"><span data-stu-id="1661b-229">The request was aborted during run time, which was usually caused by long time calculation from functions in the workbook.</span></span> <span data-ttu-id="1661b-230">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-230">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-231">**serviceUnavailableUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-231">**serviceUnavailableUncategorized**</span></span>      | <span data-ttu-id="1661b-232">服务暂时不可用或过载。</span><span class="sxs-lookup"><span data-stu-id="1661b-232">The service is temporarily unavailable or is overloaded.</span></span> <span data-ttu-id="1661b-233">Microsoft Graph 客户端不会重新发送失败的请求，直到指定的关闭持续时间过去。</span><span class="sxs-lookup"><span data-stu-id="1661b-233">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="1661b-234">**tooManyRequestsUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-234">**tooManyRequestsUncategorized**</span></span>             | <span data-ttu-id="1661b-235">失败的请求超出了某些频率限制。</span><span class="sxs-lookup"><span data-stu-id="1661b-235">The failed request exceeds certain frequency limitation.</span></span> <span data-ttu-id="1661b-236">Microsoft Graph 客户端不会重新发送失败的请求，直到指定的关闭持续时间过去。</span><span class="sxs-lookup"><span data-stu-id="1661b-236">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="1661b-237">**transientFailure**</span><span class="sxs-lookup"><span data-stu-id="1661b-237">**transientFailure**</span></span>           | <span data-ttu-id="1661b-238">由于暂时性错误，请求失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-238">The request failed due to a transient error.</span></span> <span data-ttu-id="1661b-239">Microsoft Graph 客户端不会重新发送失败的请求，直到指定的关闭持续时间过去。</span><span class="sxs-lookup"><span data-stu-id="1661b-239">The Microsoft Graph client is not expected to resend the failed request until the specified cooldown duration passes.</span></span>
| <span data-ttu-id="1661b-240">**unauthorizedUncategorized**</span><span class="sxs-lookup"><span data-stu-id="1661b-240">**unauthorizedUncategorized**</span></span>         | <span data-ttu-id="1661b-241">资源所需的身份验证信息缺失或无效。</span><span class="sxs-lookup"><span data-stu-id="1661b-241">Required authentication information for the resource is either missing or invalid.</span></span> <span data-ttu-id="1661b-242">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-242">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-243">**unsupportedOperation**</span><span class="sxs-lookup"><span data-stu-id="1661b-243">**unsupportedOperation**</span></span>         | <span data-ttu-id="1661b-244">不支持正在尝试的操作。</span><span class="sxs-lookup"><span data-stu-id="1661b-244">The operation being attempted is not supported.</span></span> <span data-ttu-id="1661b-245">Microsoft Graph 客户端不应重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-245">The Microsoft Graph client is not expected to resend the failed request.</span></span>
| <span data-ttu-id="1661b-246">**unsupportedWorkbook**</span><span class="sxs-lookup"><span data-stu-id="1661b-246">**unsupportedWorkbook**</span></span>         | <span data-ttu-id="1661b-247">请求失败。</span><span class="sxs-lookup"><span data-stu-id="1661b-247">The request failed.</span></span> <span data-ttu-id="1661b-248">工作簿包含不受支持的功能或超出大小限制。</span><span class="sxs-lookup"><span data-stu-id="1661b-248">The workbook contains unsupported features or exceeds the size limit.</span></span> <span data-ttu-id="1661b-249">在删除不受支持的因素之前，Microsoft Graph 客户端不会重新发送失败的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-249">The Microsoft Graph client is not expected to resend the failed request until the unsupported factors are removed.</span></span>

><span data-ttu-id="1661b-250">**注意：** 对于常规模式，失败的请求定义为与响应对应的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-250">**Note:** For the regular pattern, the failed request is defined as the request corresponding to the response.</span></span> <span data-ttu-id="1661b-251">对于长时间运行的操作模式，失败的请求是触发失败操作的请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-251">For the long-running operation pattern, the failed request is the one that triggers the failed operation.</span></span>

### <a name="3-parse-the-top-level-error-code"></a><span data-ttu-id="1661b-252">3. 分析顶级错误代码</span><span class="sxs-lookup"><span data-stu-id="1661b-252">3. Parse the top-level error code</span></span>

<span data-ttu-id="1661b-253">如果找不到"详细错误代码"主题中列出的二级错误代码，我们建议您[](workbook-error-codes.md#detailed-error-code)按照针对顶级错误提供的说明操作。</span><span class="sxs-lookup"><span data-stu-id="1661b-253">If you can't find the second-level error code listed in the [Detailed error codes](workbook-error-codes.md#detailed-error-code) topic, we recommend that you follow the instructions provided for top-level errors.</span></span> <span data-ttu-id="1661b-254">顶级错误代码绑定到状态代码，你可以根据相应的状态代码采取措施。</span><span class="sxs-lookup"><span data-stu-id="1661b-254">The top-level error codes are bound to the status code and you can take action according to the corresponding status codes.</span></span> <span data-ttu-id="1661b-255">有关顶级错误代码和消息的详细信息，请参阅 [错误代码](workbook-error-codes.md#error-code)。</span><span class="sxs-lookup"><span data-stu-id="1661b-255">For details about top-level error codes and messages, see [Error codes](workbook-error-codes.md#error-code).</span></span>

### <a name="4-parse-the-status-code"></a><span data-ttu-id="1661b-256">4. 分析状态代码</span><span class="sxs-lookup"><span data-stu-id="1661b-256">4. Parse the status code</span></span>

<span data-ttu-id="1661b-257">如果您遇到的错误代码不在二级列表或顶级列表中，我们建议您根据 HTTP 状态代码采取措施。</span><span class="sxs-lookup"><span data-stu-id="1661b-257">If the error code you encounter is not in the second-level list or the top-level list, we recommend that you take action according to the HTTP status code.</span></span>

### <a name="5-error-recovery-cooldown"></a><span data-ttu-id="1661b-258">5. 错误恢复关闭</span><span class="sxs-lookup"><span data-stu-id="1661b-258">5. Error recovery cooldown</span></span>

<span data-ttu-id="1661b-259">对于常规模式中的一些响应，恢复冷持续时间（以秒计）可能通过标头 `Retry-After` 提供。</span><span class="sxs-lookup"><span data-stu-id="1661b-259">For some of the responses in the regular pattern, a recovery cooldown duration in seconds might be provided via a `Retry-After` header.</span></span> <span data-ttu-id="1661b-260">当存在恢复冷淡持续时间时，Microsoft Graph 客户端不会在指定的持续时间过去之前发送任何后续请求。</span><span class="sxs-lookup"><span data-stu-id="1661b-260">When a recovery cooldown duration is present, the Microsoft Graph client is not expected to send any followup requests before the specified duration passes.</span></span>

## <a name="special-case-handling"></a><span data-ttu-id="1661b-261">特殊情况处理</span><span class="sxs-lookup"><span data-stu-id="1661b-261">Special case handling</span></span>

<span data-ttu-id="1661b-262">对于[](excel-manage-sessions.md#request-types)会话请求，如果遇到错误或错误，当二级错误代码在详细错误代码中列出时，请分析二级代码并按照相应的说明操作;否则，我们将重新确认您直接重新创建会话。 `502/badGateway` `503/serviceUnavailable` [](workbook-error-codes.md#detailed-error-code)</span><span class="sxs-lookup"><span data-stu-id="1661b-262">For [sessionful requests](excel-manage-sessions.md#request-types), if you encounter a `502/badGateway` or `503/serviceUnavailable` error, when a second-level error code is listed in [Detailed error codes](workbook-error-codes.md#detailed-error-code), parse the second-level code and follow the corresponding instructions; otherwise, we reconmmend that you recreate the session directly.</span></span>
<!-- {
  "type": "#page.annotation",
  "description": "Error handling in Excel Graph.",
  "keywords": "error response, error object, error codes, innerError, error handling",
  "section": "documentation",
  "tocPath": ""
} -->
