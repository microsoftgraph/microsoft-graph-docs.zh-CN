---
title: 使用 Microsoft 搜索 API 查询数据
description: 使用搜索 API，应用程序可以在已认证用户的上下文中搜索 Microsoft 365 数据
localization_priority: Priority
author: nmoreau
ms.prod: search
doc_type: resourcePageType
ms.openlocfilehash: 070d799c80fd9d10916d9adfb3a48a9d033883af
ms.sourcegitcommit: 1b09298649d5606b471b4cbe1055419bbe2fc7e5
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2021
ms.locfileid: "52067038"
---
# <a name="use-the-microsoft-search-api-to-query-data"></a><span data-ttu-id="111df-103">使用 Microsoft 搜索 API 查询数据</span><span class="sxs-lookup"><span data-stu-id="111df-103">Use the Microsoft Search API to query data</span></span>

[!INCLUDE [beta-disclaimer](../../includes/beta-disclaimer.md)]

<span data-ttu-id="111df-104">可使用 Microsoft 搜索 API 来查询应用程序中的 Microsoft 365 数据。</span><span class="sxs-lookup"><span data-stu-id="111df-104">You can use the Microsoft Search API to query Microsoft 365 data in your apps.</span></span>

<span data-ttu-id="111df-105">搜索请求在登录用户的上下文中运行，并使用[包含委派权限的访问令牌](/graph/auth-v2-user)进行标识。</span><span class="sxs-lookup"><span data-stu-id="111df-105">Search requests run in the context of the signed-in user, identified using an [access token with delegated permissions](/graph/auth-v2-user).</span></span>

[!INCLUDE [search-api-deprecation](../../includes/search-api-deprecation.md)]

## <a name="common-use-cases"></a><span data-ttu-id="111df-106">常见用例</span><span class="sxs-lookup"><span data-stu-id="111df-106">Common use cases</span></span>

<span data-ttu-id="111df-107">Microsoft Search API 提供了[查询](../api/search-query.md)方法，可在 Microsoft Search 中搜索数据，在其请求正文中传递 [searchRequest](searchRequest.md) ，定义搜索的具体内容。</span><span class="sxs-lookup"><span data-stu-id="111df-107">The Microsoft Search API provides a [query](../api/search-query.md) method to search across your data in Microsoft Search, where you pass a [searchRequest](searchRequest.md) in the request body, defining the specifics of your search.</span></span>

<span data-ttu-id="111df-108">本部分列出了 **查询** 方法的常见用例，具体取决于在 **查询** [searchRequest](searchRequest.md)正文中设置的属性和参数。</span><span class="sxs-lookup"><span data-stu-id="111df-108">This section lists the common use cases of the **query** method, based on the properties and parameters you set in the **query** [searchRequest](searchRequest.md) body.</span></span>

<span data-ttu-id="111df-109">代表用户运行搜索请求。</span><span class="sxs-lookup"><span data-stu-id="111df-109">Search requests run on behalf of the user.</span></span> <span data-ttu-id="111df-110">设定搜索结果范围，以强制执行应用到项目的任何访问控制。</span><span class="sxs-lookup"><span data-stu-id="111df-110">Search results are scoped to enforce any access control applied to the items.</span></span>  <span data-ttu-id="111df-111">例如，在文件的上下文中，将在搜索请求过程中评估对文件的权限。</span><span class="sxs-lookup"><span data-stu-id="111df-111">For example, in the context of files, permissions on the files are evaluated as part of the search request.</span></span> <span data-ttu-id="111df-112">在搜索中，用户无法访问更多的项目，但可以从具有相同权限和访问控制的相应 GET 操作中获得这些项目。</span><span class="sxs-lookup"><span data-stu-id="111df-112">Users cannot access more items in a search than they can otherwise obtain from a corresponding GET operation with the same permissions and access control.</span></span>

| <span data-ttu-id="111df-113">用例</span><span class="sxs-lookup"><span data-stu-id="111df-113">Use cases</span></span> | <span data-ttu-id="111df-114">要在查询请求正文中定义的属性</span><span class="sxs-lookup"><span data-stu-id="111df-114">Properties to define in the query request body</span></span> |
|:------------------|:---------|
|[<span data-ttu-id="111df-115">根据实体类型限定搜索范围</span><span class="sxs-lookup"><span data-stu-id="111df-115">Scope search results based on entity types</span></span>](#scope-search-based-on-entity-types)| <span data-ttu-id="111df-116">**entityTypes**</span><span class="sxs-lookup"><span data-stu-id="111df-116">**entityTypes**</span></span> |
|[<span data-ttu-id="111df-117">页面结果</span><span class="sxs-lookup"><span data-stu-id="111df-117">Page results</span></span>](#page-search-results) | <span data-ttu-id="111df-118">**起始数量** 和 **大小**</span><span class="sxs-lookup"><span data-stu-id="111df-118">**from** and **size**</span></span> |
|[<span data-ttu-id="111df-119">获取最相关的电子邮件</span><span class="sxs-lookup"><span data-stu-id="111df-119">Get the most relevant emails</span></span>](#get-the-most-relevant-emails) | <span data-ttu-id="111df-120">**enableTopResults**</span><span class="sxs-lookup"><span data-stu-id="111df-120">**enableTopResults**</span></span> |
|[<span data-ttu-id="111df-121">获取选定属性</span><span class="sxs-lookup"><span data-stu-id="111df-121">Get selected properties</span></span>](#get-selected-properties) | <span data-ttu-id="111df-122">**fields**</span><span class="sxs-lookup"><span data-stu-id="111df-122">**fields**</span></span> |
|[<span data-ttu-id="111df-123">在查询条款中使用 KQL</span><span class="sxs-lookup"><span data-stu-id="111df-123">Use KQL in query terms</span></span>](#keyword-query-language-kql-support) | <span data-ttu-id="111df-124">**查询**</span><span class="sxs-lookup"><span data-stu-id="111df-124">**query**</span></span> |
|[<span data-ttu-id="111df-125">排序搜索结果</span><span class="sxs-lookup"><span data-stu-id="111df-125">Sort search results</span></span>](#sort-search-results)| <span data-ttu-id="111df-126">**sort**</span><span class="sxs-lookup"><span data-stu-id="111df-126">**sort**</span></span> |
|[<span data-ttu-id="111df-127">使用聚合优化结果</span><span class="sxs-lookup"><span data-stu-id="111df-127">Refine results using aggregations</span></span>](#refine-results-using-aggregations)| <span data-ttu-id="111df-128">**聚合**</span><span class="sxs-lookup"><span data-stu-id="111df-128">**aggregations**</span></span> |
|[<span data-ttu-id="111df-129">使用连接器搜索导入的自定义类型</span><span class="sxs-lookup"><span data-stu-id="111df-129">Search custom types imported using connectors</span></span>](/graph/search-concept-custom-types)| <span data-ttu-id="111df-130">**contentSources**</span><span class="sxs-lookup"><span data-stu-id="111df-130">**contentSources**</span></span> |
|[<span data-ttu-id="111df-131">请求拼写更正</span><span class="sxs-lookup"><span data-stu-id="111df-131">Request spelling correction</span></span>](#request-spelling-correction)| <span data-ttu-id="111df-132">**queryAlterationOptions**</span><span class="sxs-lookup"><span data-stu-id="111df-132">**queryAlterationOptions**</span></span> |

## <a name="scope-search-based-on-entity-types"></a><span data-ttu-id="111df-133">根据实体类型限定搜索范围</span><span class="sxs-lookup"><span data-stu-id="111df-133">Scope search based on entity types</span></span>

<span data-ttu-id="111df-134">使用 **查询** 请求有效负载中的 **entityTypes** 属性定义搜索请求的范围。</span><span class="sxs-lookup"><span data-stu-id="111df-134">Define the scope of the search request using the **entityTypes** property in the **query** request payload.</span></span>
<span data-ttu-id="111df-135">下表介绍了可用于查询的类型以及访问数据所支持的权限。</span><span class="sxs-lookup"><span data-stu-id="111df-135">The following table describes the types available to query and the supported permissions to access the data.</span></span>

| <span data-ttu-id="111df-136">EntityType</span><span class="sxs-lookup"><span data-stu-id="111df-136">EntityType</span></span> | <span data-ttu-id="111df-137">访问项目所需的权限范围</span><span class="sxs-lookup"><span data-stu-id="111df-137">Permission scope required to access the items</span></span>| <span data-ttu-id="111df-138">Source</span><span class="sxs-lookup"><span data-stu-id="111df-138">Source</span></span>| <span data-ttu-id="111df-139">评论</span><span class="sxs-lookup"><span data-stu-id="111df-139">Comment</span></span>|
|:------------------|:---------|:---------|:---------|
|[<span data-ttu-id="111df-140">message</span><span class="sxs-lookup"><span data-stu-id="111df-140">message</span></span>](message.md)|<span data-ttu-id="111df-141">Mail.Read、Mail.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="111df-141">Mail.Read, Mail.ReadWrite</span></span>| <span data-ttu-id="111df-142">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="111df-142">Exchange Online</span></span>| <span data-ttu-id="111df-143">电子邮件。</span><span class="sxs-lookup"><span data-stu-id="111df-143">Email messages.</span></span>|
|[<span data-ttu-id="111df-144">event</span><span class="sxs-lookup"><span data-stu-id="111df-144">event</span></span>](event.md) |<span data-ttu-id="111df-145">Calendars.Read、Calendars.ReadWrite</span><span class="sxs-lookup"><span data-stu-id="111df-145">Calendars.Read, Calendars.ReadWrite</span></span>| <span data-ttu-id="111df-146">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="111df-146">Exchange Online</span></span>|<span data-ttu-id="111df-147">日历事件。</span><span class="sxs-lookup"><span data-stu-id="111df-147">Calendar events.</span></span> |
|[<span data-ttu-id="111df-148">drive</span><span class="sxs-lookup"><span data-stu-id="111df-148">drive</span></span>](drive.md)|<span data-ttu-id="111df-149">Files.Read.All、Files.ReadWrite.All、Sites.Read.All、Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="111df-149">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="111df-150">SharePoint</span><span class="sxs-lookup"><span data-stu-id="111df-150">SharePoint</span></span> | <span data-ttu-id="111df-151">文档库。</span><span class="sxs-lookup"><span data-stu-id="111df-151">Document libraries.</span></span>|
|[<span data-ttu-id="111df-152">driveItem</span><span class="sxs-lookup"><span data-stu-id="111df-152">driveItem</span></span>](driveitem.md)|<span data-ttu-id="111df-153">Files.Read.All、Files.ReadWrite.All、Sites.Read.All、Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="111df-153">Files.Read.All, Files.ReadWrite.All, Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="111df-154">SharePoint 和 OneDrive</span><span class="sxs-lookup"><span data-stu-id="111df-154">SharePoint and OneDrive</span></span> | <span data-ttu-id="111df-155">文件、文件夹、页面和新闻。</span><span class="sxs-lookup"><span data-stu-id="111df-155">Files, folders, pages, and news.</span></span> |
|[<span data-ttu-id="111df-156">列表</span><span class="sxs-lookup"><span data-stu-id="111df-156">list</span></span>](list.md)|<span data-ttu-id="111df-157">Sites.Read.All、Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="111df-157">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="111df-158">SharePoint 和 OneDrive</span><span class="sxs-lookup"><span data-stu-id="111df-158">SharePoint and OneDrive</span></span> | <span data-ttu-id="111df-159">列表。</span><span class="sxs-lookup"><span data-stu-id="111df-159">Lists.</span></span> <span data-ttu-id="111df-160">请注意，文档库也作为列表返回。</span><span class="sxs-lookup"><span data-stu-id="111df-160">Note that document libraries are also returned as lists.</span></span> |
|[<span data-ttu-id="111df-161">listItem</span><span class="sxs-lookup"><span data-stu-id="111df-161">listItem</span></span>](listitem.md)|<span data-ttu-id="111df-162">Sites.Read.All、Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="111df-162">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="111df-163">SharePoint 和 OneDrive</span><span class="sxs-lookup"><span data-stu-id="111df-163">SharePoint and OneDrive</span></span> | <span data-ttu-id="111df-164">列表项。</span><span class="sxs-lookup"><span data-stu-id="111df-164">List items.</span></span> <span data-ttu-id="111df-165">请注意，文件和文件夹也作为列表项返回；**driveItem** 是 **driveItem** 的超类。</span><span class="sxs-lookup"><span data-stu-id="111df-165">Note that files and folders are also returned as list items; **listItem** is the super class of **driveItem**.</span></span> |
|[<span data-ttu-id="111df-166">网站</span><span class="sxs-lookup"><span data-stu-id="111df-166">site</span></span>](site.md)|<span data-ttu-id="111df-167">Sites.Read.All、Sites.ReadWrite.All</span><span class="sxs-lookup"><span data-stu-id="111df-167">Sites.Read.All, Sites.ReadWrite.All</span></span>| <span data-ttu-id="111df-168">SharePoint</span><span class="sxs-lookup"><span data-stu-id="111df-168">SharePoint</span></span> | <span data-ttu-id="111df-169">SharePoint 中的网站。</span><span class="sxs-lookup"><span data-stu-id="111df-169">Sites in SharePoint.</span></span>|
|[<span data-ttu-id="111df-170">externalItem</span><span class="sxs-lookup"><span data-stu-id="111df-170">externalItem</span></span>](externalitem.md)|<span data-ttu-id="111df-171">ExternalItem.Read.All</span><span class="sxs-lookup"><span data-stu-id="111df-171">ExternalItem.Read.All</span></span>| <span data-ttu-id="111df-172">Microsoft Graph 连接器</span><span class="sxs-lookup"><span data-stu-id="111df-172">Microsoft Graph connectors</span></span>| <span data-ttu-id="111df-173">所有内容通过 Microsoft Graph 连接器 API 摄取。</span><span class="sxs-lookup"><span data-stu-id="111df-173">All content ingested with the Microsoft Graph connectors API.</span></span>|

## <a name="page-search-results"></a><span data-ttu-id="111df-174">页面搜索结果</span><span class="sxs-lookup"><span data-stu-id="111df-174">Page search results</span></span>

<span data-ttu-id="111df-175">通过在 **查询** 请求正文中指定以下两个属性来控制搜索结果的分页：</span><span class="sxs-lookup"><span data-stu-id="111df-175">Control pagination of the search results by specifying the following two properties in the **query** request body:</span></span>

- <span data-ttu-id="111df-176">**起始数量** - 一个整数，它表示从 0 开始的起始数，在页面上列出搜索结果。</span><span class="sxs-lookup"><span data-stu-id="111df-176">**from** - An integer that indicates the 0-based starting point to list search results on the page.</span></span> <span data-ttu-id="111df-177">默认值为 0。</span><span class="sxs-lookup"><span data-stu-id="111df-177">The default value is 0.</span></span>

- <span data-ttu-id="111df-178">**大小** - 一个整数，它表示要为页面返回的结果数。</span><span class="sxs-lookup"><span data-stu-id="111df-178">**size** - An integer that indicates the number of results to be returned for a page.</span></span> <span data-ttu-id="111df-179">默认值为 25。</span><span class="sxs-lookup"><span data-stu-id="111df-179">The default value is 25.</span></span>

<span data-ttu-id="111df-180">如果你正在搜索 **event** 或 **message** 实体，则注意以下限制：</span><span class="sxs-lookup"><span data-stu-id="111df-180">Note the following limits if you're searching the **event** or **message** entity:</span></span>

- <span data-ttu-id="111df-181">**起始数量** 在第一个页面请求中必须从零开始，否则请求将导致出现 HTTP 400 `Bad request`。</span><span class="sxs-lookup"><span data-stu-id="111df-181">**from** must start at zero in the first page request; otherwise, the request results in an HTTP 400 `Bad request`.</span></span>
- <span data-ttu-id="111df-182">每页的 **message** 和 **event** 最大结果数（**大小**）为 25。</span><span class="sxs-lookup"><span data-stu-id="111df-182">The maximum results per page (**size**) is 25 for **message** and **event**.</span></span> 

<span data-ttu-id="111df-183">SharePoint 或 OneDrive 项没有上限。</span><span class="sxs-lookup"><span data-stu-id="111df-183">There is no upper limit for SharePoint or OneDrive items.</span></span> <span data-ttu-id="111df-184">合理的页面大小是 200。</span><span class="sxs-lookup"><span data-stu-id="111df-184">A reasonable page size is 200.</span></span> <span data-ttu-id="111df-185">较大的页面大小通常会导致更高的延迟。</span><span class="sxs-lookup"><span data-stu-id="111df-185">A larger page size generally incurs higher latency.</span></span>

<span data-ttu-id="111df-186">最佳实践：</span><span class="sxs-lookup"><span data-stu-id="111df-186">Best practices:</span></span>

- <span data-ttu-id="111df-187">指定初始请求中的较小的首页。</span><span class="sxs-lookup"><span data-stu-id="111df-187">Specify a smaller first page in the initial request.</span></span> <span data-ttu-id="111df-188">例如，将 **起始数量** 指定为 0，将 **大小** 指定为 25。</span><span class="sxs-lookup"><span data-stu-id="111df-188">For example, specify **from** as 0, **size** as 25.</span></span>
- <span data-ttu-id="111df-189">通过更新 **起始数量** 和 **大小** 属性来对后续页面进行分页。</span><span class="sxs-lookup"><span data-stu-id="111df-189">Paginate subsequent pages by updating the **from** and **size** properties.</span></span> <span data-ttu-id="111df-190">可以在每个后续请求中增加页面大小。</span><span class="sxs-lookup"><span data-stu-id="111df-190">You can increase the page size in each subsequent request.</span></span> <span data-ttu-id="111df-191">下表显示了一个示例。</span><span class="sxs-lookup"><span data-stu-id="111df-191">The following table shows an example.</span></span>

    | <span data-ttu-id="111df-192">页面</span><span class="sxs-lookup"><span data-stu-id="111df-192">Page</span></span> | <span data-ttu-id="111df-193">起始数量</span><span class="sxs-lookup"><span data-stu-id="111df-193">from</span></span> | <span data-ttu-id="111df-194">大小</span><span class="sxs-lookup"><span data-stu-id="111df-194">size</span></span> |
    |:-----|:-----|:-----|
    | <span data-ttu-id="111df-195">1</span><span class="sxs-lookup"><span data-stu-id="111df-195">1</span></span>    | <span data-ttu-id="111df-196">0</span><span class="sxs-lookup"><span data-stu-id="111df-196">0</span></span> | <span data-ttu-id="111df-197">25</span><span class="sxs-lookup"><span data-stu-id="111df-197">25</span></span> |
    | <span data-ttu-id="111df-198">2</span><span class="sxs-lookup"><span data-stu-id="111df-198">2</span></span>    | <span data-ttu-id="111df-199">25</span><span class="sxs-lookup"><span data-stu-id="111df-199">25</span></span> | <span data-ttu-id="111df-200">50</span><span class="sxs-lookup"><span data-stu-id="111df-200">50</span></span> |
    | <span data-ttu-id="111df-201">3</span><span class="sxs-lookup"><span data-stu-id="111df-201">3</span></span>    | <span data-ttu-id="111df-202">75</span><span class="sxs-lookup"><span data-stu-id="111df-202">75</span></span> | <span data-ttu-id="111df-203">75</span><span class="sxs-lookup"><span data-stu-id="111df-203">75</span></span> |
    | <span data-ttu-id="111df-204">4</span><span class="sxs-lookup"><span data-stu-id="111df-204">4</span></span>    | <span data-ttu-id="111df-205">150</span><span class="sxs-lookup"><span data-stu-id="111df-205">150</span></span> | <span data-ttu-id="111df-206">100</span><span class="sxs-lookup"><span data-stu-id="111df-206">100</span></span> |

## <a name="get-the-most-relevant-emails"></a><span data-ttu-id="111df-207">获取最相关的电子邮件</span><span class="sxs-lookup"><span data-stu-id="111df-207">Get the most relevant emails</span></span>

<span data-ttu-id="111df-208">搜索 **message** 实体时，将 **enableTopResults** 指定为 `true` 返回邮件的混合列表：响应中的前 3 封邮件按相关性排序，剩余邮件按日期/时间排序。</span><span class="sxs-lookup"><span data-stu-id="111df-208">When searching the **message** entity, specifying **enableTopResults** as `true` returns a hybrid list of messages: the first three messages in the response are sorted by relevance; the remaining messages are sorted by date/time.</span></span>

## <a name="get-selected-properties"></a><span data-ttu-id="111df-209">获取选定属性</span><span class="sxs-lookup"><span data-stu-id="111df-209">Get selected properties</span></span>

<span data-ttu-id="111df-210">搜索实体类型，如 **message**、**event**、**drive**、**driveItem**、**list**、**listItem**、**site**、**externalItem**，可以在 **fields** 属性中包含特定的实体属性，以便在搜索结果中返回。</span><span class="sxs-lookup"><span data-stu-id="111df-210">When searching an entity type, such as **message**, **event**, **drive**, **driveItem**, **list**, **listItem**, **site**, **externalItem**, you can include in the **fields** property specific entity properties to return in the search results.</span></span> <span data-ttu-id="111df-211">这类似于使用 [OData 系统查询选项，REST 请求中的 $select](/graph/query-parameters#select-parameter)。</span><span class="sxs-lookup"><span data-stu-id="111df-211">This is similar to using the [OData system query option, $select](/graph/query-parameters#select-parameter) in REST requests.</span></span> <span data-ttu-id="111df-212">搜索 API 技术上不支持这些查询选项，因为会在文章正文中表达该行为。</span><span class="sxs-lookup"><span data-stu-id="111df-212">The search API does not technically support these query options because the behavior is expressed in the POST body.</span></span>

<span data-ttu-id="111df-213">对于所有这些实体类型，指定 **fields** 属性可减少响应中返回的属性数，从而通过网络优化负载。</span><span class="sxs-lookup"><span data-stu-id="111df-213">For all these entity types, specifying the **fields** property reduces the number of properties returned in the response, optimizing the payload over the wire.</span></span>

<span data-ttu-id="111df-214">**listItem** 和 **externalItem** 实体是唯一支持的实体，可用于获取架构中配置的扩展字段。</span><span class="sxs-lookup"><span data-stu-id="111df-214">The **listItem** and **externalItem** entities are the only supported entities that allow getting extended fields configured in the schema.</span></span> <span data-ttu-id="111df-215">无法从所有其他实体检索扩展属性。</span><span class="sxs-lookup"><span data-stu-id="111df-215">You cannot retrieve extended properties from all the other entities.</span></span> <span data-ttu-id="111df-216">例如，如果在搜索架构中创建了 **externalItem** 的字段，或者 **listItem** 上有自定义列，则可以从搜索中检索这些属性。</span><span class="sxs-lookup"><span data-stu-id="111df-216">For example, if you created a field for **externalItem** in the search schema, or if you have a custom column on a **listItem**, you can retrieve these properties from search.</span></span> <span data-ttu-id="111df-217">若要检索文件的扩展属性，请在请求中指定 **listItem** 类型。</span><span class="sxs-lookup"><span data-stu-id="111df-217">To retrieve an extended property on a file, specify the **listItem** type in the request.</span></span>

<span data-ttu-id="111df-218">如果请求中指定的 **fields** 在架构中不存在，则在响应中将不会返回这些字段。</span><span class="sxs-lookup"><span data-stu-id="111df-218">If the **fields** specified in the request are not present in the schema, they will not be returned in the response.</span></span> <span data-ttu-id="111df-219">请求中的无效字段将忽略静默。</span><span class="sxs-lookup"><span data-stu-id="111df-219">Invalid fields in the request are silently ignored.</span></span>

<span data-ttu-id="111df-220">如果你在请求中未指定任何 **字段**，则将获得所有类型的默认属性集。</span><span class="sxs-lookup"><span data-stu-id="111df-220">If you do not specify any **fields** in the request,  you will get the default set of properties for all types.</span></span> <span data-ttu-id="111df-221">对于扩展属性，在请求中未传递任何 **字段** 时，**listItem** 和 **externalItem** 的行为不同：</span><span class="sxs-lookup"><span data-stu-id="111df-221">For extended properties, **listItem** and **externalItem** behave differently when no **fields** are passed in the request:</span></span>

- <span data-ttu-id="111df-222">**listItem** 不会返回任何自定义字段。</span><span class="sxs-lookup"><span data-stu-id="111df-222">**listItem** will not return any custom field.</span></span>
- <span data-ttu-id="111df-223">**externalItem** 将返回该特定连接的 Microsoft Graph 连接器架构中标记有 **retrievable** 属性的所有字段。</span><span class="sxs-lookup"><span data-stu-id="111df-223">**externalItem** will return all the fields marked with the **retrievable** attribute in the Microsoft Graph connector schema for that particular connection.</span></span>

## <a name="keyword-query-language-kql-support"></a><span data-ttu-id="111df-224">关键字查询语言 (KQL) 支持</span><span class="sxs-lookup"><span data-stu-id="111df-224">Keyword Query Language (KQL) support</span></span>

<span data-ttu-id="111df-225">在实际搜索查询字符串（**查询** 请求正文的 **查询** 属性）中的 KQL 语法中，指定自由文本关键字、运算符（例如 `AND`、`OR`）和属性限制。</span><span class="sxs-lookup"><span data-stu-id="111df-225">Specify free text keywords, operators (such as `AND`, `OR`), and property restrictions in KQL syntax in the actual search query string (**query** property of the **query** request body).</span></span> <span data-ttu-id="111df-226">语法和命令取决于在同一 **查询** 请求主体中指向的实体类型（在 **entityTypes** 属性中）。</span><span class="sxs-lookup"><span data-stu-id="111df-226">The syntax and command depend on the entity types (in the **entityTypes** property) you target in the same **query** request body.</span></span>

<span data-ttu-id="111df-227">可搜索的属性各不相同，具体取决于实体类型。</span><span class="sxs-lookup"><span data-stu-id="111df-227">Depending on the entity type, the searchable properties vary.</span></span> <span data-ttu-id="111df-228">有关详细信息，请参阅：</span><span class="sxs-lookup"><span data-stu-id="111df-228">For details, see:</span></span>

- [<span data-ttu-id="111df-229">电子邮件属性</span><span class="sxs-lookup"><span data-stu-id="111df-229">Email properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-email-properties)
- [<span data-ttu-id="111df-230">站点属性</span><span class="sxs-lookup"><span data-stu-id="111df-230">Site properties</span></span>](/microsoft-365/compliance/keyword-queries-and-search-conditions#searchable-site-properties)

## <a name="sort-search-results"></a><span data-ttu-id="111df-231">排序搜索结果</span><span class="sxs-lookup"><span data-stu-id="111df-231">Sort search results</span></span>

<span data-ttu-id="111df-232">响应中的搜索结果按以下默认排序顺序排列：</span><span class="sxs-lookup"><span data-stu-id="111df-232">Search results in the response are sorted in the following default sort order:</span></span>

- <span data-ttu-id="111df-233">**message** 和 **event** 按日期进行排序。</span><span class="sxs-lookup"><span data-stu-id="111df-233">**message** and **event** are sorted by date.</span></span>
- <span data-ttu-id="111df-234">所有 SharePoint、OneDrive 和连接器类型按相关性排序。</span><span class="sxs-lookup"><span data-stu-id="111df-234">All SharePoint, OneDrive and connector types are sorted by relevance.</span></span>

<span data-ttu-id="111df-235">[query](../api/search-query.md) 方法可通过在 `requests` 参数中指定 **sortProperties** 来自定义搜索顺序，后者是 [searchRequest](./searchrequest.md) 对象的集合。</span><span class="sxs-lookup"><span data-stu-id="111df-235">The [query](../api/search-query.md) method lets you customize the search order by specifying the **sortProperties** on the `requests` parameter, which is a collection of [searchRequest](./searchrequest.md) objects.</span></span> <span data-ttu-id="111df-236">这可用于指定一个或多个可排序的属性列表和排序顺序。</span><span class="sxs-lookup"><span data-stu-id="111df-236">This allows you to specify a list of one or more sortable properties and the sort order.</span></span>

<span data-ttu-id="111df-237">请注意，目前仅支持以下 SharePoint 和 OneDrive 类型的排序结果：[driveItem](driveitem.md)、[listItem](listitem.md)、[list](list.md)、[site](site.md)。</span><span class="sxs-lookup"><span data-stu-id="111df-237">Note that sorting results is currently only supported on the following SharePoint and OneDrive types: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md), [site](site.md).</span></span>

<span data-ttu-id="111df-238">应用排序子句的属性需要在 SharePoint [搜索架构](/sharepoint/manage-search-schema)中可排序。</span><span class="sxs-lookup"><span data-stu-id="111df-238">The properties on which the sort clause are applied need to be sortable in the SharePoint [search schema](/sharepoint/manage-search-schema).</span></span> <span data-ttu-id="111df-239">如果请求中指定的属性不可排序或不存在，则响应将返回错误， `HTTP 400 Bad Request`。</span><span class="sxs-lookup"><span data-stu-id="111df-239">If the property specified in the request is not sortable or does not exist, the response will return an error, `HTTP 400 Bad Request`.</span></span> <span data-ttu-id="111df-240">请注意，不能指定按使用 [sortProperty](sortproperty.md) 的相关性对文档进行排序。</span><span class="sxs-lookup"><span data-stu-id="111df-240">Note that you cannot specify to sort documents by relevance using [sortProperty](sortproperty.md).</span></span>

<span data-ttu-id="111df-241">指定 [sortProperty](sortproperty.md) 对象的 **名称** 时，可使用 Microsoft Graph 类型的属性名称（例如 [driveItem](driveitem.md)），或搜索索引中托管属性的名称。</span><span class="sxs-lookup"><span data-stu-id="111df-241">When specifying the **name** of a [sortProperty](sortproperty.md) object, you can either use the property name from the Microsoft Graph type (for example, in [driveItem](driveitem.md)), or the name of the managed property in the search index.</span></span>

<span data-ttu-id="111df-242">有关演示如何对结果进行排序的示例，请参阅[对搜索结果进行排序](/graph/search-concept-sort)。</span><span class="sxs-lookup"><span data-stu-id="111df-242">See [sort search results](/graph/search-concept-sort) for examples that show how to sort results.</span></span>

## <a name="refine-results-using-aggregations"></a><span data-ttu-id="111df-243">使用聚合优化结果</span><span class="sxs-lookup"><span data-stu-id="111df-243">Refine results using aggregations</span></span>

<span data-ttu-id="111df-244">聚合（SharePoint 中也称为精简程序）是增强搜索体验的一种常见的方式。</span><span class="sxs-lookup"><span data-stu-id="111df-244">Aggregations (also known as refiners in SharePoint) are a very popular way to enhance a search experience.</span></span> <span data-ttu-id="111df-245">除结果外，还提供有关匹配的搜索结果集的一些级别的聚合信息。</span><span class="sxs-lookup"><span data-stu-id="111df-245">In addition to the results, they provide some level of aggregate information on the matching set of search results.</span></span> <span data-ttu-id="111df-246">例如，你可以提供与查询匹配的文档最多作者和表示的文件类型等信息。</span><span class="sxs-lookup"><span data-stu-id="111df-246">For example, you can provide information on the most represented authors of the documents matching the query, or the most represented file types, etc.</span></span>

<span data-ttu-id="111df-247">在 [searchRequest](./searchrequest.md)中，指定除了搜索结果以外应返回的聚合。</span><span class="sxs-lookup"><span data-stu-id="111df-247">In the [searchRequest](./searchrequest.md), specify the aggregations that should be returned in addition to the search results.</span></span> <span data-ttu-id="111df-248">每个聚合的说明在 [aggregationOption](./aggregationoption.md) 中定义，其指定要在其中计算聚合的属性，以及在响应中需要返回的 [searchBucket](searchBucket.md) 数目。</span><span class="sxs-lookup"><span data-stu-id="111df-248">The description of each aggregation is defined in the [aggregationOption](./aggregationoption.md), which specifies the property on which the aggregation should be computed, and the number of [searchBucket](searchBucket.md) to be returned in the response.</span></span>

<span data-ttu-id="111df-249">应用排序子句的属性需要在 SharePoint [搜索架构](/sharepoint/manage-search-schema)中可排序。</span><span class="sxs-lookup"><span data-stu-id="111df-249">The properties on which the aggregation is requested need to be refinable in the SharePoint [search schema](/sharepoint/manage-search-schema).</span></span> <span data-ttu-id="111df-250">如果指定的属性不可精简或不存在，则响应将返回 `HTTP 400 Bad Request`。</span><span class="sxs-lookup"><span data-stu-id="111df-250">If the property specified is not refinable or does not exist, the response returns `HTTP 400 Bad Request`.</span></span>

<span data-ttu-id="111df-251">返回包含 [searchBucket](searchBucket.md) 对象的集合的响应后，可将搜索请求精确到 [searchBucket](searchBucket.md)中包含的匹配元素。</span><span class="sxs-lookup"><span data-stu-id="111df-251">Once the response is returned containing the collection of [searchBucket](searchBucket.md) objects, it is possible to refine the search request to only the matching elements contained in one [searchBucket](searchBucket.md).</span></span> <span data-ttu-id="111df-252">为实现此操作，可将 **aggregationFilters** 属性中的 **aggregationsFilterToken** 值返回到后续 [searchRequest](./searchrequest.md)中。</span><span class="sxs-lookup"><span data-stu-id="111df-252">This is achieved by passing back the  **aggregationsFilterToken** value in the **aggregationFilters** property of the subsequent [searchRequest](./searchrequest.md).</span></span>

<span data-ttu-id="111df-253">聚合目前仅支持在以下 SharePoint 和 OneDrive 类型上的任何可细化属性：[driveItem](driveitem.md)、[listItem](listitem.md)、[列表](list.md)、[网站](site.md)以及在Microsoft Graph 连接器上的 [externalItem](externalItem.md)。</span><span class="sxs-lookup"><span data-stu-id="111df-253">Aggregations are currently supported for any refinable property on the following SharePoint and OneDrive types: [driveItem](driveitem.md), [listItem](listitem.md), [list](list.md), [site](site.md), and on Microsoft Graph connectors [externalItem](externalItem.md).</span></span>

<span data-ttu-id="111df-254">请参阅[优化搜索结果](/graph/search-concept-aggregation) ，显示使用聚合增强和缩小搜索结果的示例。</span><span class="sxs-lookup"><span data-stu-id="111df-254">See [refine search results](/graph/search-concept-aggregation) for examples that show using aggregation to enhance and narrow down search results.</span></span>

## <a name="request-spelling-correction"></a><span data-ttu-id="111df-255">请求拼写更正</span><span class="sxs-lookup"><span data-stu-id="111df-255">Request spelling correction</span></span>

<span data-ttu-id="111df-256">拼写更正是处理用户查询中的拼写错误和匹配内容中正确单词之间差异的常用方法。</span><span class="sxs-lookup"><span data-stu-id="111df-256">Spelling correction is a popular way to handle mismatches between typos in a user query and the correct words in matched contents.</span></span> <span data-ttu-id="111df-257">在原始用户查询中检测到拼写错误时，可以获得原始用户查询或更正的备用查询的搜索结果。</span><span class="sxs-lookup"><span data-stu-id="111df-257">When typos are detected in the original user query, you can get the search result either for the original user query or the corrected alternate query.</span></span> <span data-ttu-id="111df-258">还可以在 [searchresponse](searchresponse.md) 的 **queryAlterationResponse** 属性中获取拼写错误的拼写更正信息。</span><span class="sxs-lookup"><span data-stu-id="111df-258">You can also get the spelling correction information for typos in the **queryAlterationResponse** property of the [searchresponse](searchresponse.md).</span></span> 

<span data-ttu-id="111df-259">在 [Query](/graph/api/search-query?view=graph-rest-beta&preserve-view=true) 方法的请求正文中，指定应应用于查询以进行拼写更正的 **queryAlterationOptions**。</span><span class="sxs-lookup"><span data-stu-id="111df-259">In the request body of the [query](/graph/api/search-query?view=graph-rest-beta&preserve-view=true) method, specify the **queryAlterationOptions** that should be applied to the query for spelling corrections.</span></span> <span data-ttu-id="111df-260">在 [searchAlterationOptions](./searchalterationoptions.md) 中定义 **queryAlterationOptions** 的描述。</span><span class="sxs-lookup"><span data-stu-id="111df-260">The description of **queryAlterationOptions** is defined in the [searchAlterationOptions](./searchalterationoptions.md).</span></span>

<span data-ttu-id="111df-261">有关如何使用拼写更正的示例，请参见[请求拼写更正](/graph/search-concept-speller)。</span><span class="sxs-lookup"><span data-stu-id="111df-261">For examples that show how to use spelling corrections, see [Request spelling correction](/graph/search-concept-speller).</span></span>

## <a name="error-handling"></a><span data-ttu-id="111df-262">错误处理</span><span class="sxs-lookup"><span data-stu-id="111df-262">Error handling</span></span>

<span data-ttu-id="111df-263">搜索 API 将返回由 [OData 错误对象定义](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse)所定义的错误响应，其中每个是包含代码和消息的 JSON 对象。</span><span class="sxs-lookup"><span data-stu-id="111df-263">The search API returns error responses as defined by [OData error object definition](http://docs.oasis-open.org/odata/odata-json-format/v4.01/cs01/odata-json-format-v4.01-cs01.html#sec_ErrorResponse), each of which is a JSON object containing a code and a message.</span></span>

<!---TODOSEARCHAPI Describe the know errors: bad requests.--->

## <a name="known-limitations"></a><span data-ttu-id="111df-264">已知限制</span><span class="sxs-lookup"><span data-stu-id="111df-264">Known limitations</span></span>

<span data-ttu-id="111df-265">搜索 API 存在以下限制：</span><span class="sxs-lookup"><span data-stu-id="111df-265">The search API has the following limitations:</span></span>

- <span data-ttu-id="111df-266">定义 **查询** 方法，以允许一次传递一个或多个 **searchRequest** 实例的集合。</span><span class="sxs-lookup"><span data-stu-id="111df-266">The **query** method is defined to allow passing a collection of one or more **searchRequest** instances at once.</span></span> <span data-ttu-id="111df-267">但是，该服务当前仅支持一次传递一个 [searchRequest](./searchrequest.md)。</span><span class="sxs-lookup"><span data-stu-id="111df-267">However, the service currently supports only a single [searchRequest](./searchrequest.md) at a time.</span></span>

- <span data-ttu-id="111df-268">[searchRequest](./searchrequest.md) 资源支持一次传递多个类型的实体。</span><span class="sxs-lookup"><span data-stu-id="111df-268">The [searchRequest](./searchrequest.md) resource supports passing multiple types of entities at a time.</span></span> <span data-ttu-id="111df-269">但是，目前仅支持 SharePoint 和 OneDrive entityTypes 的组合为：**driveItem**、**drive**、**site**、**list**、**listItem**。</span><span class="sxs-lookup"><span data-stu-id="111df-269">However, currently the only supported combination is for SharePoint and OneDrive entityTypes: **driveItem**, **drive**, **site**, **list**, **listItem**.</span></span>
<span data-ttu-id="111df-270">当前不支持任何涉及 **message**、**event**、Sharepoint 和 OneDrive 类型或 **externalItem** 的组合。</span><span class="sxs-lookup"><span data-stu-id="111df-270">Any combinations involving **message**, **event**, SharePoint and OneDrive types , or **externalItem** are currently not supported.</span></span>  

- <span data-ttu-id="111df-271">仅当将 **entityType** 指定为 `externalItem` 时，定义要使用的连接的 **contentSource** 属性才适用。</span><span class="sxs-lookup"><span data-stu-id="111df-271">The **contentSource** property, which defines the connection to use, is only applicable when **entityType** is specified as `externalItem`.</span></span>

- <span data-ttu-id="111df-272">搜索 API 不支持 **message**、**event** 或 **externalItem** 的自定义排序。</span><span class="sxs-lookup"><span data-stu-id="111df-272">The search API does not support custom sort for **message**, **event** or  **externalItem**.</span></span>

- <span data-ttu-id="111df-273">搜索 API 不支持 **message**、**event**、**site** 或 **drive** 的聚合。</span><span class="sxs-lookup"><span data-stu-id="111df-273">The search API does not support aggregations for **message**, **event**, **site** or **drive**.</span></span>

- <span data-ttu-id="111df-274">SharePoint 搜索中的自定义设置（如自定义搜索架构或结果源）可能会干扰 Microsoft 搜索 API 的操作。</span><span class="sxs-lookup"><span data-stu-id="111df-274">Customizations in SharePoint search, such as a custom search schema or result sources, can interfere with the operation of the Microsoft Search API.</span></span>

## <a name="schema-change-deprecation-warning"></a><span data-ttu-id="111df-275">架构更改否决警告</span><span class="sxs-lookup"><span data-stu-id="111df-275">Schema change deprecation warning</span></span>

<span data-ttu-id="111df-276">**在测试版中**，已重命名或删除搜索请求和响应中使用的属性。</span><span class="sxs-lookup"><span data-stu-id="111df-276">**In the beta version**, properties used in a search request and response have been renamed or removed.</span></span> <span data-ttu-id="111df-277">在大多数情况下，原始属性将被否决并被当前属性替换，如下表所列。</span><span class="sxs-lookup"><span data-stu-id="111df-277">In most cases, the original properties are being deprecated and replaced by the current properties, as listed in the following table.</span></span>

<span data-ttu-id="111df-278">开始更新任何现有应用，以使用当前属性和类型名称，以及在响应中获取当前属性名称。</span><span class="sxs-lookup"><span data-stu-id="111df-278">Start updating any existing apps to use current property and type names, and to get current property names in the response.</span></span>
<span data-ttu-id="111df-279">为使向后兼容，原始属性和类型可访问且可以正常工作，直到 **2020 年 12 月 31 日**，之后它们将被删除。</span><span class="sxs-lookup"><span data-stu-id="111df-279">For backward compatibility, the original properties and types are accessible and functional until **December 31, 2020**, after which they will be removed.</span></span>

| <span data-ttu-id="111df-280">资源</span><span class="sxs-lookup"><span data-stu-id="111df-280">Resource</span></span>                           | <span data-ttu-id="111df-281">更改类型</span><span class="sxs-lookup"><span data-stu-id="111df-281">Change type</span></span>   | <span data-ttu-id="111df-282">原始属性</span><span class="sxs-lookup"><span data-stu-id="111df-282">Original property</span></span> | <span data-ttu-id="111df-283">当前属性</span><span class="sxs-lookup"><span data-stu-id="111df-283">Current property</span></span>|
|:-----------------------------------|:--------------|:------------------|:----------------|
| [<span data-ttu-id="111df-284">searchRequest</span><span class="sxs-lookup"><span data-stu-id="111df-284">searchRequest</span></span>](./searchrequest.md)| <span data-ttu-id="111df-285">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-285">Rename property</span></span> | <span data-ttu-id="111df-286">**stored_fields**</span><span class="sxs-lookup"><span data-stu-id="111df-286">**stored_fields**</span></span> | <span data-ttu-id="111df-287">**fields**</span><span class="sxs-lookup"><span data-stu-id="111df-287">**fields**</span></span>      |
| [<span data-ttu-id="111df-288">searchQuery</span><span class="sxs-lookup"><span data-stu-id="111df-288">searchQuery</span></span>](./searchquery.md)    | <span data-ttu-id="111df-289">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-289">Rename property</span></span> | <span data-ttu-id="111df-290">**query_string**</span><span class="sxs-lookup"><span data-stu-id="111df-290">**query_string**</span></span> | <span data-ttu-id="111df-291">**queryString**</span><span class="sxs-lookup"><span data-stu-id="111df-291">**queryString**</span></span> |
| [<span data-ttu-id="111df-292">searchQueryString</span><span class="sxs-lookup"><span data-stu-id="111df-292">searchQueryString</span></span>](./searchquerystring.md) | <span data-ttu-id="111df-293">弃用资源</span><span class="sxs-lookup"><span data-stu-id="111df-293">Deprecate resource</span></span> | <span data-ttu-id="111df-294">不适用</span><span class="sxs-lookup"><span data-stu-id="111df-294">Not applicable</span></span> | <span data-ttu-id="111df-295">不适用</span><span class="sxs-lookup"><span data-stu-id="111df-295">Not applicable</span></span> |
| [<span data-ttu-id="111df-296">searchHit</span><span class="sxs-lookup"><span data-stu-id="111df-296">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="111df-297">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-297">Rename property</span></span> | <span data-ttu-id="111df-298">**_id**</span><span class="sxs-lookup"><span data-stu-id="111df-298">**_id**</span></span> | <span data-ttu-id="111df-299">**hitId**</span><span class="sxs-lookup"><span data-stu-id="111df-299">**hitId**</span></span> |
| [<span data-ttu-id="111df-300">searchHit</span><span class="sxs-lookup"><span data-stu-id="111df-300">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="111df-301">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-301">Rename property</span></span> | <span data-ttu-id="111df-302">**_score**</span><span class="sxs-lookup"><span data-stu-id="111df-302">**_score**</span></span> | <span data-ttu-id="111df-303">**rank**</span><span class="sxs-lookup"><span data-stu-id="111df-303">**rank**</span></span> |
| [<span data-ttu-id="111df-304">searchHit</span><span class="sxs-lookup"><span data-stu-id="111df-304">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="111df-305">删除属性</span><span class="sxs-lookup"><span data-stu-id="111df-305">Remove property</span></span> | <span data-ttu-id="111df-306">**_sortField**</span><span class="sxs-lookup"><span data-stu-id="111df-306">**_sortField**</span></span> | <span data-ttu-id="111df-307">不适用</span><span class="sxs-lookup"><span data-stu-id="111df-307">Not applicable</span></span> |
| [<span data-ttu-id="111df-308">searchHit</span><span class="sxs-lookup"><span data-stu-id="111df-308">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="111df-309">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-309">Rename property</span></span> | <span data-ttu-id="111df-310">**_source**</span><span class="sxs-lookup"><span data-stu-id="111df-310">**_source**</span></span> | <span data-ttu-id="111df-311">**resource**</span><span class="sxs-lookup"><span data-stu-id="111df-311">**resource**</span></span> |
| [<span data-ttu-id="111df-312">searchHit</span><span class="sxs-lookup"><span data-stu-id="111df-312">searchHit</span></span>](./searchhit.md)        | <span data-ttu-id="111df-313">重命名属性</span><span class="sxs-lookup"><span data-stu-id="111df-313">Rename property</span></span> | <span data-ttu-id="111df-314">**_summary**</span><span class="sxs-lookup"><span data-stu-id="111df-314">**_summary**</span></span>  | <span data-ttu-id="111df-315">**summary**</span><span class="sxs-lookup"><span data-stu-id="111df-315">**summary**</span></span>  |

## <a name="see-also"></a><span data-ttu-id="111df-316">另请参阅</span><span class="sxs-lookup"><span data-stu-id="111df-316">See also</span></span>

- <span data-ttu-id="111df-317">了解有关几个关键用例的详细信息：</span><span class="sxs-lookup"><span data-stu-id="111df-317">Learn more about a few key use cases:</span></span>
  - [<span data-ttu-id="111df-318">搜索 Outlook 邮件</span><span class="sxs-lookup"><span data-stu-id="111df-318">Search Outlook messages</span></span>](/graph/search-concept-messages)
  - [<span data-ttu-id="111df-319">搜索日历事件</span><span class="sxs-lookup"><span data-stu-id="111df-319">Search calendar events</span></span>](/graph/search-concept-events)
  - [<span data-ttu-id="111df-320">SharePoint 和 OneDrive 中的搜索内容</span><span class="sxs-lookup"><span data-stu-id="111df-320">Search content in Sharepoint and OneDrive</span></span>](/graph/search-concept-files)
  - [<span data-ttu-id="111df-321">使用连接器搜索导入的自定义类型</span><span class="sxs-lookup"><span data-stu-id="111df-321">Search custom types imported using connectors</span></span>](/graph/search-concept-custom-types)
  - [<span data-ttu-id="111df-322">排序搜索结果</span><span class="sxs-lookup"><span data-stu-id="111df-322">Sort search results</span></span>](/graph/search-concept-sort)
  - [<span data-ttu-id="111df-323">改进搜索结果</span><span class="sxs-lookup"><span data-stu-id="111df-323">Refine search results</span></span>](/graph/search-concept-aggregation)
  - [<span data-ttu-id="111df-324">请求拼写更正</span><span class="sxs-lookup"><span data-stu-id="111df-324">Request spelling correction</span></span>](/graph/search-concept-speller)

- <span data-ttu-id="111df-325">在 [Graph 浏览器](https://developer.microsoft.com/graph/graph-explorer)中探索搜索 API。</span><span class="sxs-lookup"><span data-stu-id="111df-325">Explore the search APIs in  [Graph Explorer](https://developer.microsoft.com/graph/graph-explorer).</span></span>

## <a name="whats-new"></a><span data-ttu-id="111df-326">最近更新</span><span class="sxs-lookup"><span data-stu-id="111df-326">What's new</span></span>

<span data-ttu-id="111df-327">了解此 API 集的[最新功能和更新](/graph/whats-new-overview)。</span><span class="sxs-lookup"><span data-stu-id="111df-327">Find out about the [latest new features and updates](/graph/whats-new-overview) for this API set.</span></span>
